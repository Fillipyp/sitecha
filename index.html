<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chá de Janela – Bruna & Fillipy</title>
    <meta name="description"
        content="Site simples e elegante para o nosso Chá de Janela, com lista de presentes reservável." />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --olive: #6B8E23;
            /* verde oliva principal */
            --olive-700: #556B2F;
            /* oliva escuro */
            --beige: #F5F0E6;
            /* bege fundo */
            --beige-2: #EBE4D7;
            /* bege claro cards */
            --ink: #2E2A24;
            /* texto */
            --muted: #7B766F;
            /* texto secundário */
            --white: #FFFFFF;
            --radius: 18px;
            --shadow: 0 10px 30px rgba(0, 0, 0, .08);
        }

        * {
            box-sizing: border-box
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            background: var(--beige);
            color: var(--ink);
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.55;
        }

        .container {
            width: min(1100px, 92vw);
            margin-inline: auto
        }

        header.hero {
            position: relative;
            overflow: hidden;
            isolation: isolate;
            background: radial-gradient(1200px 500px at 80% -10%, rgba(107, 142, 35, .12), transparent 60%),
                radial-gradient(800px 400px at 10% 0%, rgba(107, 142, 35, .10), transparent 60%),
                var(--beige);
            padding: clamp(40px, 7vw, 90px) 0 40px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 14px;
            color: var(--olive-700);
            font-weight: 600;
            letter-spacing: .5px
        }

        .brand .logo {
            display: grid;
            place-items: center;
            width: 42px;
            height: 42px;
            border-radius: 12px;
            background: linear-gradient(145deg, var(--olive), var(--olive-700));
            color: #fff;
            box-shadow: var(--shadow)
        }

        .hero-grid {
            display: grid;
            grid-template-columns: 1.1fr .9fr;
            gap: clamp(24px, 4vw, 40px);
            align-items: center
        }

        @media (max-width: 860px) {
            .hero-grid {
                grid-template-columns: 1fr;
                text-align: center
            }

        }

        h1 {
            font-family: Marcellus, serif;
            font-weight: 400;
            font-size: clamp(40px, 5.2vw, 56px);
            line-height: 1.05;
            margin: 14px 0
        }

        .lead {
            color: var(--muted);
            font-size: clamp(15px, 2.5vw, 18px)
        }

        .cta-row {
            display: flex;
            gap: 12px;
            margin-top: 22px
        }

        @media (max-width: 860px) {
            .cta-row {
                justify-content: center
            }
        }

        .btn {
            appearance: none;
            border: 0;
            border-radius: 999px;
            padding: 12px 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform .15s ease, box-shadow .2s ease, opacity .2s ease
        }

        .btn-primary {
            background: var(--olive);
            color: #fff;
            box-shadow: 0 6px 18px rgba(107, 142, 35, .25)
        }

        .btn-primary:hover {
            transform: translateY(-1px)
        }

        .btn-ghost {
            background: transparent;
            color: var(--olive-700);
            border: 1.5px solid var(--olive-700)
        }

        .soft {
            color: var(--muted);
            font-size: 16px
        }

        .photo-wrap {
            position: relative;
            display: grid;
            place-items: center
        }

        .photo-card {
            width: min(550px, 90vw);
            /* padrão desktop/tablet */
            aspect-ratio: 4/3;
            border-radius: var(--radius);
            background: var(--beige-2);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid rgba(0, 0, 0, .06);
        }

        /* ajuste para telas pequenas */
        @media (max-width: 640px) {
            .photo-card {
                width: 280px;
                /* trava num tamanho menor */
                max-width: 90vw;
                /* garante que não ultrapasse a largura */
            }

            .floating-badge {
                position: static !important;
                /* sai do canto da foto */
                margin-top: 10px;
                font-size: 14px;
                /* diminui fonte */
                padding: 8px 12px;
                /* menor altura/largura */
                align-self: center;
            }
        }


        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            filter: saturate(.92)
        }

        .floating-badge {
            position: absolute;
            right: -8px;
            bottom: -8px;
            background: var(--olive);
            color: #fff;
            padding: 10px 14px;
            border-radius: 14px;
            font-weight: 500;
            box-shadow: var(--shadow)
        }

        /* Lista de Presentes */
        section.list {
            padding: 32px 0 80px
        }

        .section-head {
            display: flex;
            align-items: end;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 14px
        }

        @media (max-width: 700px) {
            .section-head {
                flex-direction: column;
                align-items: flex-start
            }
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap
        }

        .input,
        select {
            border: 1px solid rgba(0, 0, 0, .12);
            background: #fff;
            border-radius: 12px;
            padding: 11px 12px;
            font-size: 14px
        }

        .input::placeholder {
            color: #999
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 16px;
            margin-top: 18px
        }

        .card {
            grid-column: span 4;
            background: #fff;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, .06);
            display: flex;
            flex-direction: column
        }

        .card.media {
            height: 160px;
            background: linear-gradient(180deg, rgba(107, 142, 35, .18), rgba(107, 142, 35, 0));
            display: grid;
            place-items: center
        }

        .card .body {
            padding: 14px 14px 12px;
            display: flex;
            flex-direction: column;
            gap: 8px
        }

        .card h3 {
            margin: 0;
            font-size: 17px
        }

        .price {
            color: var(--muted);
            font-size: 14px
        }

        .meta {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: space-between
        }

        .reserve-btn {
            margin-top: 6px
        }

        .reserved {
            position: relative;
            opacity: .55;
            filter: grayscale(.1)
        }

        .reserved::after {
            content: "Reservado";
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--olive-700);
            color: #fff;
            font-size: 12px;
            padding: 6px 10px;
            border-radius: 999px
        }

        @media (max-width: 1024px) {
            .card {
                grid-column: span 6
            }
        }

        @media (max-width: 640px) {
            .card {
                grid-column: span 12
            }
        }

        /* Modal simples */
        dialog {
            border: none;
            border-radius: 16px;
            padding: 0;
            width: min(520px, 92vw);
            box-shadow: var(--shadow)
        }

        .modal {
            padding: 18px
        }

        .modal h4 {
            margin: 0 0 6px 0;
            font-size: 20px
        }

        .modal .row {
            display: flex;
            gap: 10px;
            margin-top: 12px;
            flex-wrap: wrap
        }

        .modal .row .input {
            flex: 1
        }

        .modal .footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 18px
        }

        /* micro animações */
        [data-anim="fade-up"] {
            opacity: 0;
            transform: translateY(10px);
            animation: fadeUp .5s ease forwards;
        }

        @keyframes fadeUp {
            to {
                opacity: 1;
                transform: none
            }
        }

        /* ====== Sessão do Evento (centrada) ====== */
        section.event {
            padding: 48px 0 96px;
            background: linear-gradient(180deg, rgba(107, 142, 35, .06), transparent 40%)
        }

        .event-hero {
            max-width: 900px;
            margin: 0 auto;
            text-align: center
        }

        .event-address {
            display: inline-block;
            background: var(--beige-2);
            color: var(--olive-700);
            font-weight: 600;
            padding: 10px 14px;
            border-radius: 999px
        }

        .event-date {
            font-family: Marcellus, serif;
            font-weight: 400;
            font-size: clamp(32px, 6vw, 56px);
            margin: 14px 0 2px
        }

        .event-time {
            font-size: clamp(18px, 3.5vw, 24px);
            font-weight: 700;
            color: var(--olive-700)
        }

        .event-divider {
            width: 120px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--olive), transparent);
            margin: 16px auto 8px;
            position: relative
        }

        .event-actions {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 18px
        }

        /* Botões modernos na seção de evento */
        .btn-modern {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            border-radius: 999px;
            padding: 12px 20px;
            font-size: 15px;
            transition: all .2s ease;
            text-decoration: none;
        }

        .btn-modern svg {
            width: 18px;
            height: 18px;
        }

        .btn-wa {
            background: var(--beige-2);
            border: 2px solid var(--olive);
            color: var(--olive-700);
        }

        .btn-wa:hover {
            background: var(--olive);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 4px 14px rgba(107, 142, 35, .25);
        }

        .btn-map {
            background: var(--olive);
            border: 2px solid var(--olive);
            color: #fff;
        }

        .btn-map:hover {
            background: var(--olive-700);
            transform: translateY(-2px);
            box-shadow: 0 4px 14px rgba(107, 142, 35, .25);
        }

        .card.media {
            aspect-ratio: 1 / 1;
            /* quadrado */
            height: auto;
            overflow: hidden;
        }

        .card.media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* preenche cortando */
            border-radius: var(--radius);
        }
    </style>
</head>

<body>
    <header class="hero" id="topo">
        <div class="container">
            <div class="brand" aria-label="Marca">
                <div class="logo" aria-hidden="true">🎁</div>
                <span>Nosso Chá de Panela</span>
            </div>

            <div class="hero-grid">
                <div>
                    <h1 data-anim="fade-up">Bruna & Fillipy</h1>
                    <p class="lead" data-anim="fade-up" style="animation-delay:.06s">
                        Estamos muito felizes em viver este
                        momento tão especial e queremos compartilhar com vocês. </p>
                    <p class="lead" data-anim="fade-up" style="animation-delay:.06s">
                        Aqui você encontra informações sobre o evento e uma lista de presentes para nos ajudar a montar
                        o
                        nosso lar. Fique à vontade para reservar um item (ou mais) </p>

                    </p>
                    <div class="cta-row" data-anim="fade-up" style="animation-delay:.12s">
                        <a class="btn btn-primary" href="#lista" title="Ver lista de presentes">Ver lista</a>
                        <a class="btn btn-ghost" href="#evento" title="Informações do evento">Informações do Evento</a>
                    </div>
                </div>
                <div class="photo-wrap" aria-label="Foto do casal">
                    <figure class="photo-card" data-anim="fade-up" style="animation-delay:.16s">
                        <img src="imagens/fillipy&bruna.jpg" alt="Foto do casal (troque por uma sua)" />
                    </figure>
                    <div class="floating-badge" aria-hidden="true">Save the date ✨</div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- Intro editável / instruções rápidas -->
        <section id="intro" class="list">
            <div class="container">
                <div class="section-head">
                    <div>
                        <h2 style="margin:0; font-family: Marcellus, serif;">Bem-vindos ao nosso cantinho!</h2>
                        <p class="soft" style="margin-top:6px; max-width:65ch">O nosso Chá de Janela é uma forma de
                            unir carinho, amizade e os primeiros passos da nossa vida a dois. Obrigado por fazer parte
                            dessa história!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Lista de Presentes -->
        <section id="lista" class="list" aria-labelledby="titulo-lista">
            <div class="container">
                <div class="section-head">
                    <div>
                        <h2 id="titulo-lista" style="margin:0; font-family: Marcellus, serif">Lista de Presentes</h2>
                        <p class="soft" style="margin:12px 0; font-style: italic;">
                    Preferimos presentes nas cores <strong>bege</strong>, <strong>preto</strong> e
                    <strong>branco</strong>.
                </p>
                        <p class="soft" style="margin-top:6px">Para reservar um presente (ou mais), escolha o item e digite uma
                            senha.
                            Essa senha é escolhida por você mesmo e serve para garantir que o presente fique salvo em
                            seu nome.
                            Se mudar de ideia, basta usar a mesma senha para cancelar a reserva.</p>
                    </div>
                    
                    <div class="controls" role="search">
                        <input id="busca" class="input" type="search" placeholder="Buscar presente…"
                            aria-label="Buscar presente" />
                    </div>
                </div>

                


                <div id="grid" class="grid" aria-live="polite"></div>
                <p id="empty" class="soft" style="display:none; margin-top:16px">Nenhum item encontrado. Tente outra
                    busca.</p>
            </div>
        </section>

        <!-- Informações do Evento -->
        <section id="evento" class="event" aria-labelledby="titulo-evento">
            <div class="container">
                <div class="section-head" style="justify-content:center; text-align:center">
                    <div>
                        <h2 id="titulo-evento" style="margin:0; font-family: Marcellus, serif">Informações do Evento
                        </h2>
                        <p class="soft" style="margin-top:6px">Te esperamos para comemorar com a gente!</p>
                    </div>
                </div>

                <div class="event-hero">
                    <div class="event-address">📍 Av. Automóvel Clube, 78 - Centro, São João de Meriti - RJ, 25515-126
                    </div>
                    <div class="event-divider"></div>
                    <div class="event-date">15 de novembro de 2025</div>
                    <div class="event-time">15:00</div>
                    <div class="event-actions">
                        <a class="btn-modern btn-wa" target="_blank" href="https://wa.me/5521976014362?text=Oi">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.44 0 .06 5.37.06 12a11.8 11.8 0 0 0 1.65 6L0 24l6.21-1.63a11.9 11.9 0 0 0 5.85 1.5h.01c6.63 0 12-5.37 12-12 0-3.19-1.24-6.18-3.48-8.39zM12.07 22a9.9 9.9 0 0 1-5.05-1.37l-.36-.21-3.69.97.99-3.6-.24-.37a9.91 9.91 0 0 1-1.53-5.33c0-5.48 4.46-9.94 9.95-9.94a9.9 9.9 0 0 1 7.07 2.94A9.87 9.87 0 0 1 22 12c0 5.48-4.46 9.94-9.93 9.94z" />
                            </svg>
                            Falar com Bruna
                        </a>

                        <a class="btn-modern btn-wa" target="_blank" href="https://wa.me/5516981516858?text=Oi">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.44 0 .06 5.37.06 12a11.8 11.8 0 0 0 1.65 6L0 24l6.21-1.63a11.9 11.9 0 0 0 5.85 1.5h.01c6.63 0 12-5.37 12-12 0-3.19-1.24-6.18-3.48-8.39zM12.07 22a9.9 9.9 0 0 1-5.05-1.37l-.36-.21-3.69.97.99-3.6-.24-.37a9.91 9.91 0 0 1-1.53-5.33c0-5.48 4.46-9.94 9.95-9.94a9.9 9.9 0 0 1 7.07 2.94A9.87 9.87 0 0 1 22 12c0 5.48-4.46 9.94-9.93 9.94z" />
                            </svg>
                            Falar com Fillipy
                        </a>

                        <a class="btn-modern btn-map" target="_blank"
                            href="https://www.google.com/maps?q=Av.+Autom%C3%B3vel+Clube,+78+-+Centro,+S%C3%A3o+Jo%C3%A3o+de+Meriti+-+RJ,+25515-126">
                            Ver no Google Maps
                        </a>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <!-- Modal de reserva/desmarque com senha -->
    <dialog id="dlg">
        <div class="modal">
            <h4 id="dlgTitulo">Confirmar reserva</h4>
            <p class="soft" id="dlgTexto">Opcionalmente, deixe seu nome e <strong>crie uma senha</strong> para reservar
                💚</p>
            <div class="row">
                <input id="nomeReservante" class="input" placeholder="Seu nome (opcional)" />
                <input id="senhaReservante" class="input" type="password" placeholder="Senha (ex: 1234)" />
            </div>
            <div class="footer">
                <button class="btn btn-ghost" id="btnCancelar">Cancelar</button>
                <button class="btn btn-primary" id="btnConfirmar">Confirmar</button>
            </div>
        </div>
    </dialog>

    <footer class="container" style="padding:30px 0 60px; color:var(--muted); font-size:13px">
        Qualquer dúvida, entre em contato conosco pelo WhatsApp <a href="#topo"
            style="color:var(--olive-700); font-weight:600; text-decoration:none">Voltar ao topo</a>
    </footer>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

        // 🔧 COLOQUE SUAS CREDENCIAIS DO SUPABASE AQUI
        const SUPABASE_URL = 'https://miwiboaiiavyurvpwdfi.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1pd2lib2FpaWF2eXVydnB3ZGZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMDkxNzUsImV4cCI6MjA3MzY4NTE3NX0.5QB0Gx4OrHI2q6vbh8VzkbnQFRTOTXD2mWqhlTcRFuA';
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

        // ====== Dados da Lista (edite à vontade) ======
        // ====== Dados da Lista ======
        // ====== Dados da Lista ======
        const GIFTS = [
            { id: 'p1', nome: 'Conjunto de copos', img: 'imagens/copos.jpg' },
            { id: 'p2', nome: 'Cabides ', img: 'imagens/cabides.jpg' },
            { id: 'p3', nome: 'Edredom casal', img: 'imagens/edredom.jpg' },
            { id: 'p4', nome: 'Forma de gelo', img: 'imagens/forma_gelo.jpg' },
            { id: 'p5', nome: 'Funil de cozinha', img: 'imagens/funil.jpg' },
            { id: 'p6', nome: 'Conjunto de cuias ', img: 'imagens/cuia.jpg' },
            { id: 'p7', nome: 'Garrafa de café térmica', img: 'imagens/garrafa_cafe.jpg' },
            { id: 'p8', nome: 'Jogo de lençol casal', img: 'imagens/lencol.jpg' },
            { id: 'p9', nome: 'Almofadas decorativas', img: 'imagens/almofadas.jpg' },
            { id: 'p10', nome: 'Rolo de massa', img: 'imagens/rolo_massa.jpg' },
            { id: 'p11', nome: 'Vassoura', img: 'imagens/vassoura.jpg' },
            { id: 'p12', nome: 'Escova sanitária', img: 'imagens/escova_sanitaria.jpg' },
            { id: 'p13', nome: 'Edredom casal', img: 'imagens/edredom2.jpg' },
            { id: 'p14', nome: 'Manta para sofá', img: 'imagens/manta_sofa.png' },
            { id: 'p15', nome: 'Moedor de pimenta', img: 'imagens/moedor_pimenta.png' },
            { id: 'p16', nome: 'Mop de limpeza', img: 'imagens/mop.png' },
            { id: 'p17', nome: 'Panela elétrica de feijão', img: 'imagens/panela_feijao_eletrica.png' },
            { id: 'p18', nome: 'Panos de prato', img: 'imagens/pano_prato.png' },
            { id: 'p19', nome: 'Potes de plástico ', img: 'imagens/potes.png' },
            { id: 'p20', nome: 'Jogo de pratos rasos', img: 'imagens/prato_reto.png' },
            { id: 'p21', nome: 'Taças de vidro', img: 'imagens/tacas.png' },
            { id: 'p23', nome: 'Toalhas de banho', img: 'imagens/toalhas_banho2.png' },
            { id: 'p24', nome: 'Ventilador', img: 'imagens/ventilador.png' },
            { id: 'p25', nome: 'Abajur', img: 'imagens/abajur.png' },
            { id: 'p26', nome: 'Luminária de escritório', img: 'imagens/luminaria_escritorio.png' },
            { id: 'p27', nome: 'Porta-retrato (par)', img: 'imagens/porta_retrato.png' },
            { id: 'p28', nome: 'Escorredor de legumes', img: 'imagens/escorregor_legumes.png' },
            { id: 'p29', nome: 'Bacia', img: 'imagens/bacia.png' },
            { id: 'p30', nome: 'Panela de pressão (indução)', img: 'imagens/panela_pressao_inducao.png' },
            { id: 'p31', nome: 'Centrífuga de legumes', img: 'imagens/centrifuga_legumes.jpg' },
            { id: 'p32', nome: 'Kit lavabo', img: 'imagens/kit_lavabo.jpg' },
            { id: 'p33', nome: 'Jogo de prato americano', img: 'imagens/jogo_mesa_americano.jpg' },
            { id: 'p34', nome: 'Luva térmica', img: 'imagens/luva_termica.jpg' },
            { id: 'p35', nome: 'Jogo de facas', img: 'imagens/facas.png' },
            { id: 'p36', nome: 'Xícaras', img: 'imagens/xicaras.jpg' },
            { id: 'p37', nome: 'Abridor de garrafas e latas', img: 'imagens/abridor_garrafa.jpg' },
            { id: 'p38', nome: 'Açucareiro', img: 'imagens/açucareiro.jpg' },
            { id: 'p39', nome: 'Afiador de facas', img: 'imagens/afiador_facas.jpg' },
            { id: 'p40', nome: 'Assadeira antiaderente', img: 'imagens/assadeira.png' },
            { id: 'p41', nome: 'Balde', img: 'imagens/balde.png' },
            { id: 'p42', nome: 'Batedor de ovos', img: 'imagens/batedor_ovos.jpg' },
            { id: 'p43', nome: 'Bowls', img: 'imagens/bowls.png' },
            { id: 'p44', nome: 'Coador', img: 'imagens/coador.png' },
            { id: 'p45', nome: 'Colheres de pau', img: 'imagens/colher_de_pau.jpg' },
            { id: 'p46', nome: 'Concha para molho', img: 'imagens/concha_molho.jpg' },
            { id: 'p47', nome: 'Concha para sorvete', img: 'imagens/concha_sorvete.jpg' },
            { id: 'p48', nome: 'Conjunto de copos', img: 'imagens/copos_2.png' },
            { id: 'p49', nome: 'Cortador de pizza', img: 'imagens/cortador_pizza.png' },
            { id: 'p50', nome: 'Cumbucas', img: 'imagens/cumbuca_bambu.png' },
            { id: 'p51', nome: 'Descanso de panelas', img: 'imagens/descanso_panela.jpg' },
            { id: 'p52', nome: 'Escorredor de macarrão', img: 'imagens/escorredor_macarrao.jpg' },
            { id: 'p53', nome: 'Espátulas de silicone', img: 'imagens/espatulas.jpg' },
            { id: 'p55', nome: 'Espremedor de batatas', img: 'imagens/espremedor_batata.png' },
            { id: 'p56', nome: 'Espremedor de limão', img: 'imagens/espremedor_limao.png' },
            { id: 'p57', nome: 'Forma de bolo', img: 'imagens/forma_bolo.jpg' },
            { id: 'p58', nome: 'Forma de pizza', img: 'imagens/forma_pizza.png' },
            { id: 'p59', nome: 'Jarra de suco', img: 'imagens/jarra.jpg' },
            { id: 'p60', nome: 'Kit talheres', img: 'imagens/kit_talheres.png' },
            { id: 'p61', nome: 'Liquidificador', img: 'imagens/liquidificador.png' },
            { id: 'p62', nome: 'Lixeira de pia', img: 'imagens/lixeira_pia.jpg' },
            { id: 'p63', nome: 'Mantegueira de vidro', img: 'imagens/mantegueira.jpg' },
            { id: 'p64', nome: 'Pá de lixo', img: 'imagens/pá_lixo.png' },
            { id: 'p65', nome: 'Paliteiro', img: 'imagens/paliteiro.jpg' },
            { id: 'p66', nome: 'Pegador de massa', img: 'imagens/pegador_massa.png' },
            { id: 'p67', nome: 'Pegador de salada', img: 'imagens/pegador_salada.png' },
            { id: 'p68', nome: 'Petisqueira', img: 'imagens/petisqueira.png' },
            { id: 'p69', nome: 'Pirex', img: 'imagens/pirex.png' },
            { id: 'p70', nome: 'Porta chaves', img: 'imagens/porta_chaves.png' },
            { id: 'p71', nome: 'Porta frios', img: 'imagens/porta_frios.jpg' },
            { id: 'p72', nome: 'Porta temperos', img: 'imagens/porta_temperos.png' },
            { id: 'p73', nome: 'Potes Hérmeticos', img: 'imagens/jogo_pote_hermeticos.png' },
            { id: 'p74', nome: 'Queijeira', img: 'imagens/queijeira.jpg' },
            { id: 'p75', nome: 'Ralador', img: 'imagens/ralador.jpg' },
            { id: 'p76', nome: 'Rodo de pia', img: 'imagens/rodo_pia.jpg' },
            { id: 'p77', nome: 'Tábua de cozinha', img: 'imagens/tabua_cozinha.png' },
            { id: 'p78', nome: 'Tesoura de cozinha', img: 'imagens/tesoura_cozinha.png' },
            { id: 'p79', nome: 'Toalha de rosto', img: 'imagens/toalhas_banho.png' },
            { id: 'p80', nome: 'Torradeira elétrica', img: 'imagens/torradeira_eletrica.png' },
            { id: 'p81', nome: 'Travesseiros', img: 'imagens/travesseiro.png' },
            { id: 'p83', nome: 'Jogo de lençol casal', img: 'imagens/lencol2.jpg' },
            { id: 'p84', nome: 'Jogo de pratos fundos', img: 'imagens/prato_fundo.png' },
            { id: 'p85', nome: 'Airfryer', img: 'imagens/airfryer.png' },
            { id: 'p86', nome: 'Aspirador de pó', img: 'imagens/aspirador.png' },
            { id: 'p87', nome: 'Aspirador de pó', img: 'imagens/ferro_passar.png' },
        ];





        // ====== Estado vindo do Banco ======
        let reservasDB = new Map(); // Map<id, {id, nome}>

        const grid = document.getElementById('grid');
        const busca = document.getElementById('busca');
        const ordenar = document.getElementById('ordenar');
        const empty = document.getElementById('empty');

        // Modal
        const dlg = document.getElementById('dlg');
        const dlgTitulo = document.getElementById('dlgTitulo');
        const dlgTexto = document.getElementById('dlgTexto');
        const nomeReservante = document.getElementById('nomeReservante');
        const senhaReservante = document.getElementById('senhaReservante');
        const btnCancelar = document.getElementById('btnCancelar');
        const btnConfirmar = document.getElementById('btnConfirmar');
        let pendenteId = null;
        let modo = 'reservar'; // 'reservar' | 'desmarcar'

        function formatarBRL(v) { return v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }); }

        function filtrarOrdenar(lista) {
            const q = (busca?.value || '').trim().toLowerCase();
            let out = lista.filter(x => x.nome.toLowerCase().includes(q));
            if (ordenar?.value === 'nome') out.sort((a, b) => a.nome.localeCompare(b.nome));
            if (ordenar?.value === 'preco') out.sort((a, b) => a.preco - b.preco);
            return out;
        }

        function cardTemplate(item) {
            const data = reservasDB.get(item.id); // {id, nome}
            const reservado = !!data;
            const who = data?.nome || '';

            return `
    <article class="card ${reservado ? 'reserved' : ''}" data-id="${item.id}">
      <div class="card media">
        <img alt="${item.nome}" src="${item.img}">
      </div>
      <div class="body">
        <h3>${item.nome}</h3>
        <p class="soft">
          ${reservado
                    ? `Reservado ${who ? 'por <strong style="color:var(--olive-700)">' + who + '</strong>' : ''}`
                    : 'Clique abaixo para reservar este item'}
        </p>
        <button class="btn btn-primary reserve-btn" data-pressed="${reservado}" aria-pressed="${reservado}">
          ${reservado ? 'Desmarcar' : 'Reservar'}
        </button>
      </div>
    </article>`;
        }



        function render() {
            const items = filtrarOrdenar(GIFTS);
            grid.innerHTML = items.map(cardTemplate).join('');
            empty.style.display = items.length ? 'none' : 'block';
        }

        // ====== Supabase: CRUD ======
        async function carregarReservas() {
            const { data, error } = await supabase.from('reservas').select('id, nome');
            if (error) { console.error('Erro ao carregar reservas:', error); reservasDB = new Map(); }
            else { reservasDB = new Map((data || []).map(r => [r.id, r])); }
            render();
        }

        function abrirModalReservar() {
            dlgTitulo.textContent = 'Confirmar reserva';
            dlgTexto.innerHTML = 'Opcionalmente, deixe seu nome e <strong>crie uma senha</strong> para reservar 💚';
            nomeReservante.style.display = 'block';
            senhaReservante.value = '';
            dlg.showModal();
        }

        function abrirModalDesmarcar() {
            dlgTitulo.textContent = 'Desmarcar presente';
            dlgTexto.textContent = 'Digite a senha usada na reserva para liberar o presente.';
            nomeReservante.style.display = 'none';
            senhaReservante.value = '';
            dlg.showModal();
        }

        function toggleReserva(id) {
            if (reservasDB.has(id)) {
                pendenteId = id; modo = 'desmarcar'; abrirModalDesmarcar();
            } else {
                pendenteId = id; modo = 'reservar'; abrirModalReservar();
            }
        }

        // Eventos UI
        busca?.addEventListener('input', render);
        ordenar?.addEventListener('change', render);
        grid.addEventListener('click', async (e) => {
            const btn = e.target.closest('.reserve-btn');
            if (!btn) return;
            const card = e.target.closest('.card');
            const id = card?.dataset.id;
            if (id) toggleReserva(id);
        });

        btnCancelar.addEventListener('click', () => { dlg.close(); pendenteId = null; });
        btnConfirmar.addEventListener('click', async () => {
            if (!pendenteId) return dlg.close();

            if (modo === 'reservar') {
                const senha = (senhaReservante.value || '').trim();
                if (!senha) { alert('Por favor, crie uma senha para reservar.'); return; }
                const nome = (nomeReservante.value || '').trim();
                const { error } = await supabase.from('reservas').insert({ id: pendenteId, nome, senha });
                if (error) {
                    // 23505 = unique_violation (alguém reservou no mesmo instante)
                    if (error.code === '23505') alert('Ops! Esse presente acabou de ser reservado por outra pessoa.');
                    else alert('Erro ao reservar: ' + error.message);
                } else {
                    dlg.close();
                }
                await carregarReservas();
                pendenteId = null;
                return;
            }

            if (modo === 'desmarcar') {
                const senha = (senhaReservante.value || '').trim();
                const { data, error } = await supabase.from('reservas').select('senha').eq('id', pendenteId).single();
                if (error || !data) { alert('Reserva não encontrada.'); return; }
                if (data.senha !== senha) { alert('Senha incorreta! Não foi possível desmarcar.'); return; }
                const { error: delErr } = await supabase.from('reservas').delete().eq('id', pendenteId);
                if (delErr) { alert('Erro ao desmarcar: ' + delErr.message); }
                else { dlg.close(); }
                await carregarReservas();
                pendenteId = null;
            }
        });

        // Inicial
        await carregarReservas();

        // Realtime: atualiza UI quando alguém reservar/desmarcar
        supabase.channel('reservas-stream')
            .on('postgres_changes', { event: '*', schema: 'public', table: 'reservas' }, () => carregarReservas())
            .subscribe();

        // ====== Acessório: rolagem suave para âncoras ======
        document.querySelectorAll('a[href^="#"]').forEach(a => {
            a.addEventListener('click', (e) => {
                const href = a.getAttribute('href');
                const target = document.querySelector(href);
                if (target) { e.preventDefault(); target.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
            });
        });

        /* ====== NOTA (RLS) ======
         * Ative RLS e crie policies que permitam SELECT/INSERT/DELETE para anon.
         * Exemplo rápido (no SQL Editor):
         *   alter table reservas enable row level security;
         *   create policy "public select" on reservas for select using (true);
         *   create policy "public insert" on reservas for insert with check (true);
         *   create policy "public delete" on reservas for delete using (true);
         */
    </script>
</body>

</html>
